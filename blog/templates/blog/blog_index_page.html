{% extends layout_template %}

{% load common_tags %}
{% load wagtailcore_tags %}

{% block main %}

	<h2 class="page-title">{{ page.title }}</h2>

	{% for block in page.body %}
		<section class="blog-index">{% include_block block %}</section>
	{% endfor %}

	{% block ajax %}
		{% if author_filter %}
			<div class="blog-filter">
				You are looking at articles written by
				{% if author_filter.website %}
					<a href="{{ author_filter.website }}">{{ author_filter.title }}</a>
				{% else %}
					{{ author_filter.title }}
				{% endif %}
				<div class="blog-filter__clear">
					<a href="{{ page.url }}">&times; See All Articles</a>
				</div>
			</div>
		{% endif %}
		{% if organization_filter %}
			<div class="blog-filter">
				You are looking at articles from
				{% if organization_filter.website %}
					<a href="{{ organization_filter.website }}">{{ organization_filter.title }}</a>
				{% else %}
					{{ organization_filter.title }}
				{% endif %}
				<div class="blog-filter__clear">
					<a href="{{ page.url }}">&times; See All Articles</a>
				</div>
			</div>
		{% endif %}

		<div class="js-infinite-scrolling-parent">
			{% for post in entries_page %}
				<div class="js-infinite-scrolling-item">
					{% include "blog/_blog_tease.html" with page=post.specific location="blog-index" single_column=True %}
				</div>
			{% endfor %}
		</div>

		{% if entries_page.has_previous %}
			<a
				href="?{% query_transform request page=entries_page.previous_page_number %}"
				class="js-infinite-scrolling-prev-link"
			>
				Previous Page
			</a>
		{% endif %}

		{% if entries_page.has_next %}
			<a
				href="?{% query_transform request page=entries_page.next_page_number %}"
				class="button button--outline button--center js-infinite-scrolling-next-link"
			>
				More Posts
			</a>
		{% endif %}
	{% endblock %}
{% endblock %}

{% block top_sidebar_class %}
	{% if author_filter or organization_filter %}
		{{block.super}} layout-right-sidebar__sidebar--light
	{% endif %}
{% endblock %}

{% block sidebar_class %}
	{% if author_filter or organization_filter %}
		layout-right-sidebar__sidebar--light
	{% endif %}
{% endblock %}

{% block sidebar %}
	{% if author_filter %}
		{% include "blog/_about_author.html" with author=author_filter %}
	{% endif %}

	{% if organization_filter %}
		{% include "blog/_about_org.html" with organization=organization_filter %}
	{% endif %}
{% endblock %}


