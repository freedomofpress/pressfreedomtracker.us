{% extends "base.html" %}

{% load wagtailcore_tags %}

{% block flex_class %}
  flex-container--grow-3
{% endblock %}

{% block top_sidebar_class %}
  layout-right-sidebar__sidebar--light
{% endblock%}

{% block secondary-header %}
<div class="layout-right-sidebar">
  <div class="layout-right-sidebar__main
              layout-right-sidebar__main--dark
              layout-right-sidebar__main--{{ page.title|slugify }}"
  >
      <div class="category">
        <h3 class="category__name">
          {{ page.title }}
        </h3>
        <div class="category__description">
          {{ page.description|richtext }}
        </div>
      </div>
  </div>
  <div class="layout-right-sidebar__sidebar
              layout-right-sidebar__sidebar--dark
              layout-right-sidebar__sidebar--{{ page.title|slugify }}"
  >
      {% if page.quick_facts.all %}
      <div class="quickfacts">
          <h4 class="section-heading">Quickfacts</h4>
          <ul class="quickfacts__list">
            {% for fact in page.quick_facts.all %}
              <li class="quickfacts__item">
                {{ fact.body|richtext }}
              </li>
            {% endfor %}
          </ul>
      </div>
      {% endif %}
  </div>
</div>
{% endblock %}

{% block main_class %}
  layout-right-sidebar__main--padded
{% endblock %}

{% block main %}
  <div class="incident-grid">
    {% for incident in page.incidents.all %}
      <div class="incident-grid__item">
        {% include "incident/_incident.html" with incident=incident.incident_page teaser=True %}
      </div>
    {% empty %}
      <p>There are no incidents in this category yet.</p>
    {% endfor %}
  </div>
{% endblock %}


{% block sidebar_class %}
  layout-right-sidebar__sidebar--light
  layout-right-sidebar__sidebar--padded
{% endblock %}

{% block sidebar %}
  <div class="category-sidebar">
    <h4 class="section-heading">
      Data Summary
    </h4>
    <table class="data-table">
      <tr class='data-table__row'>
        <th class="data-table__label">
          Total cases
        </th>
        <td class="data-table__value">{{ page.incidents.all.count }}</td>
      </tr>
      <tr class='data-table__row'>
        <th class="data-table__label">
          Cases in 2019
        </th>
        <td class="data-table__value">33</td>
      </tr>
    </table>
    {% if page.methodology %}
      <h4 class="section-heading">
        How we track {{page.title}}
      </h4>
      <div>
        {{ page.methodology|richtext }}
      </div>
    {% endif %}
  </div>
{% endblock %}
